{% load static %}
<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>Enter Subject Marks - {{ class_subject.subject.name }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">

<div class="max-w-7xl mx-auto bg-white p-6 rounded shadow">
  <h1 class="text-2xl font-bold mb-4">Enter Marks for {{ class_subject.subject.name }} ({{ class_subject.classroom.name }})</h1>
  <p class="mb-4 font-semibold">Examination: {{ examination.name }}</p>

  <form method="post" class="space-y-6">
    {% csrf_token %}
    <table class="table-auto w-full border-collapse border border-gray-300">
      <thead>
        <tr class="bg-gray-200">
          <th class="border border-gray-300 p-2 text-left">Roll No</th>
          <th class="border border-gray-300 p-2 text-left">Student Name</th>
          <th class="border border-gray-300 p-2 text-center">Theory Marks (Max {{ max_theory }})</th>
          <th class="border border-gray-300 p-2 text-center">Practical Marks (Max {{ max_practical }})</th>
        </tr>
      </thead>
      <tbody>
        {% for student in students %}
          {% with mark=marks_dict|get_item:student.id %}
          <tr class="hover:bg-gray-50">
            <td class="border border-gray-300 p-2">{{ student.roll_number }}</td>
            <td class="border border-gray-300 p-2">{{ student.first_name }} {{ student.last_name }}</td>

            {% with
                theory=mark.theory_marks|default:0
                practical=mark.practical_marks|default:0
                theory_pass=theory >= pass_theory
                practical_pass=practical >= pass_practical
            %}
            <td class="border border-gray-300 p-2 text-center">
              <input
                type="number"
                name="theory_{{ student.id }}"
                step="0.01"
                min="0"
                max="{{ max_theory }}"
                value="{{ theory }}"
                class="w-20 p-1 border rounded
                {% if theory_pass %}text-green-600{% else %}text-red-600{% endif %}"
              />
            </td>
            <td class="border border-gray-300 p-2 text-center">
              <input
                type="number"
                name="practical_{{ student.id }}"
                step="0.01"
                min="0"
                max="{{ max_practical }}"
                value="{{ practical }}"
                class="w-20 p-1 border rounded
                {% if practical_pass %}text-green-600{% else %}text-red-600{% endif %}"
              />
            </td>
            {% endwith %}
          </tr>
          {% endwith %}
        {% empty %}
          <tr>
            <td colspan="4" class="text-center p-4 text-gray-500">No students found in this class.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="mt-4 text-right">
      <button
        type="submit"
        class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
      >Save Marks</button>
    </div>
  </form>
</div>

</body>
</html>
